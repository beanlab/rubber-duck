# Anchors
file_size_limit: &file_size_limit 4096 # 4KB limit
file_type_ext:
  &file_type_ext [
    "txt",
    "py",
    "java",
    "cpp",
    "c",
    "h",
    "hpp",
    "js",
    "ts",
    "html",
    "css",
    "md",
  ]

sql:
  db_type: sqlite
  database: /rubber-duck.db

containers:
  - name: stats-python-sandbox
    image: byucscourseops/python-tools-sandbox:latest
    cpu_limit: 1
    memory_limit: 512m
    network: disabled
    timeout: 30
    mounts:
      - s3://bucket/file.txt: /data/file.txt
      - datasets/foo.csv: /data/foo.csv

tools:
  - name: run_python
    type: container_exec
    container: stats-python-sandbox


agents_as_tools:
  - tool_name: check_suspicion_bot
    doc_string: |
      This tool determines if a user's message is suspicious. Suspicious messages are those that do not appear to follow the format
      of a user's name (first_name_last_name). The tool checks for profanity, unusual characters, and other indicators of suspicious behavior.
      If the message is suspicious, the tool returns a formatted output indicating the reason for suspicion. If the message is not suspicious,
      the tool returns a formatted output indicating that the message is safe.
    agent:
      name: SuspicionChecker
      prompt_files:
        - prompts/production-prompts/suspicion-checker.txt
      engine: gpt-5-mini
      reasoning: minimal
      tools: [ ]
      output_format:
        format:
          type: json_schema
          name: suspicion_output
          strict: true
          schema:
            type: object
            properties:
              suspicious:
                type: boolean
                description: Indicates if the name is suspicious according to the agent.
              reason:
                type: string
                description: The reason why the name is considered suspicious or safe.
            required: [ "suspicious", "reason" ]
            additionalProperties: false

  - tool_name: code_complexity_agent
    doc_string: |
      This tool analyzes the complexity of source code and returns a string describing the order of complexity. 
      This tool takes source code as a string and returns a string describing the order of complexity (Big-O analysis) of the provided code.
    agent:
      name: CodeComplexityAgent
      prompt_files:
        - prompts/312-project-design/generate-code-complexity.md
      engine: gpt-4.1
      tools: [ ]

ducks:
  - name: standard-rubber-duck
    duck_type: agent_led_conversation
    settings:
      agent:
        name: RubberDuck
        prompt_files:
          - prompts/production-prompts/standard-rubber-duck.md
        engine: gpt-5-mini
        reasoning: minimal
        tools:
          - talk_to_user
          - conclude_conversation
      file_size_limit: *file_size_limit
      file_type_ext: *file_type_ext

  - name: stats-duck-legacy
    duck_type: user_led_conversation
    settings:
      agent:
        name: stats_duck_legacy
        prompt_files:
          - prompts/production-prompts/stats-legacy.txt
        engine: gpt-5
        reasoning: minimal
        tools:
          - describe_dataset
          - list_categories
          - explain_capabilities
          - get_dataset_names
          - get_variable_names
          - show_dataset_head
          - plot_histogram
          - plot_density
          - plot_boxplot
          - plot_dotplot
          - plot_barplot
          - plot_pie_chart
          - plot_proportion_barplot
          - plot_scatterplot
          - calculate_mean
          - calculate_skewness
          - calculate_std
          - calculate_median
          - calculate_mode
          - calculate_five_number_summary
          - calculate_table_of_counts
          - calculate_proportions
          - calculate_z_score
          - calculate_probability_from_normal_distribution
          - calculate_percentiles_from_normal_distribution
          - plot_normal_distribution
          - calculate_confidence_interval_and_t_test
          - plot_confidence_interval_and_t_distribution
          - calculate_two_mean_t_test
          - calculate_one_way_anova
          - calculate_one_sample_proportion_z_test
          - calculate_two_sample_proportion_z_test
          - simple_linear_regression
      introduction: "Hi, I can help with your stats questions! Let me know what you're thinking"
      file_size_limit: *file_size_limit
      file_type_ext: *file_type_ext

  - name: stats-duck
    duck_type: user_led_conversation
    settings:
      introduction: How can I help you with stats?
      agent:
        name: stats_duck
        prompt_files:
          - prompts/production-prompts/stats.md
        engine: gpt-5-mini
        reasoning: minimal
        tools:
          - run_python
        file_size_limit: *file_size_limit
        file_type_ext: *file_type_ext

servers:
  927616651409649675:
    server_name: CS 110
    channels:
      - channel_id: 1296158078017736725
        channel_name: review-cs-110
        ducks:
          - name: Conversation-Review-cs110
            duck_type: conversation_review
            settings:
              target_channel_ids:
                - 1234556460453597276
        timeout: 300

      - channel_id: 1234556460453597276
        channel_name: general/duck-pond
        ducks:
          - standard-rubber-duck
        timeout: 600

      - channel_id: 1399777118380097648
        channel_name: join-the-server
        ducks:
          - name: Registration-Workflow-CS110
            duck_type: registration
            settings:
              cache_timeout: 60800
              authenticated_user_role_name: Student
              email_domain: byu.edu
              ta_channel_id: 1413242197398126613
              suspicion_checker_tool: check_suspicion_bot
              roles:
                patterns:
                  - name: Teacher Sections
                    pattern: "-section-"
                    description: Sorted by teacher's name (e.g. smith-section-000)
        timeout: 600

  911014551263268916:
    server_name: CS Faculty
    channels:
      - channel_id: 1146906576788140154
        channel_name: Duck Pond
        timeout: 600
        ducks:
          - standard-rubber-duck

  747510855536738336:
    server_name: CS 235
    channels:
      - channel_id: 1327385245036838912
        channel_name: review-cs-235
        ducks:
          - name: Conversation-Review-CS235
            duck_type: conversation_review
            settings:
              target_channel_ids:
                - 1195490291134779502
        timeout: 300

      - channel_id: 1195490291134779502
        channel_name: student-text-channels/duck-pond
        ducks:
          - standard-rubber-duck
        timeout: 600

      - channel_id: 1399788047981351042
        channel_name: join-the-server
        ducks:
          - name: Registration-Workflow-CS235
            duck_type: registration
            settings:
              cache_timeout: 60800
              authenticated_user_role_name: Student
              email_domain: byu.edu
              roles:
                patterns:
                  - name: Teacher Sections
                    pattern: "-section-"
                    description: Sorted by teacher name (e.g. smith-section-001)
        timeout: 600


  1235303213796691998:
    server_name: CS 111
    channels:
      - channel_id: 1329934513333338244
        channel_name: review-cs-111
        ducks:
          - name: Conversation-Review-CS111
            duck_type: conversation_review
            settings:
              target_channel_ids:
                - 1406039546721730582
        timeout: 300

      - channel_id: 1406039546721730582
        channel_name: Student Text Channels/duck-pond
        ducks:
          - standard-rubber-duck
        timeout: 600

  1407758127608365157:
    server_name: BYU - CS 312
    channels:
      - channel_id: 1407761075226542120
        channel_name: register
        timeout: 300
        ducks:
          - name: Registration-Workflow-CS312
            duck_type: registration
            settings:
              cache_timeout: 60800
              authenticated_user_role_name: student
              email_domain: byu.edu
              ta_channel_id: 1413242407566315550
              suspicion_checker_tool: check_suspicion_bot
              roles:
                patterns:
                  - name: Lecture Sections
                    pattern: "lecture-"
                    description: Who teaches your lecture?
      - channel_id: 1442908120488743113
        channel_name: duck-pond
        timeout: 600
        ducks:
          - standard-rubber-duck
      - channel_id: 1442908158757437502
        channel_name: project-review
        timeout: 300
        ducks:
          - name: cs312-grader
            duck_type: assignment_feedback
            settings:
              name: cs312-projects
              initial_instructions: |
                This AI tool takes a report in markdown format and determines if it meets a set of rubric requirements.
                
                The feedback provided by this tool is intended to be a helpful "second set of eyes" on your report; 
                it is not intended as a definitive statement on whether your report is correct.
                
                Note:
                - This generated feedback does **not** check images and may give inaccurate feedback regarding images.
                - The rubrics used the tool to grade your project may differ slightly from the ones in Canvas and might not include the coding requirements.
                
                Provide your feedback about using this tool in #ai-feedback . When relevant, please include a link to this thread in your feedback.

              gradable_assignments:
                - name: Project Report - Alignment
                  rubric_path: [rubrics/alignment-rubric.yaml, rubrics/cs312-project-rules.yaml]

                - name: Project Report - Backtracking
                  rubric_path: [rubrics/backtracking-rubric.yaml, rubrics/cs312-project-rules.yaml]

                - name: Project Report - Branch and Bound
                  rubric_path: [rubrics/branch-and-bound-rubric.yaml, rubrics/cs312-project-rules.yaml]

                - name: Project Leetcode
                  rubric_path: [rubrics/leetcode-rubric.yaml, rubrics/cs312-project-rules.yaml]

                - name: Project Demo Fruit
                  rubric_path: [rubrics/demo-fruit-rubric.yaml, rubrics/fruit-demo-rules.yaml]
                  message: |
                    Please note this is a demo project
        

              single_rubric_item_grader:
                # This agent expects a part of a report and a single requirement
                name: grader
                engine: gpt-5-mini
                prompt_files:
                  - prompts/assignment-feedback/tier-grader-structured-output-single.md
                reasoning: minimal
                output_format:
                  format:
                    type: json_schema
                    name: grading_output
                    strict: true
                    schema:
                      type: object
                      properties:
                        rubric_item:
                          type: string
                          description: same exact rubric item provided to you
                        justification:
                          type: string
                          description: Justification for if the report satisfied the requirement
                        satisfactory:
                          type: boolean
                          description: Indicates if the report provided meets the given rubric item
                      required: [ "rubric_item", "justification", "satisfactory" ]
                      additionalProperties: false

              project_scanner_agent:
                # This agent gets the desired report and section name(s) from the user based on the report
                name: project_scanner
                engine: gpt-5-mini
                prompt_files:
                  - prompts/assignment-feedback/project-determiner.md
                output_format:
                  format:
                    type: json_schema
                    name: project_name
                    strict: true
                    schema:
                      type: object
                      properties:
                        project_name:
                          type: string
                          description: the name of the project
                      required: [ "project_name" ]
                      additionalProperties: false

                reasoning: minimal
      - channel_id: 1442908515147710558
        channel_name: duck-review
        ducks:
          - name: Conversation-Review-CS312
            duck_type: conversation_review
            settings:
              target_channel_ids:
                - 1442908120488743113
                - 1442908158757437502
        timeout: 600


  1371951485629370458:
    server_name: Stats
    channels:
      - channel_id: 1371951756149260298
        channel_name: ta-review
        ducks:
          - name: Conversation-Review-Stats
            duck_type: conversation_review
            settings:
              target_channel_ids:
                - 1371951696061661215
                - 1374066971523678279
        timeout: 300

      - channel_id: 1404899692210553033
        channel_name: join-the-server
        ducks:
          - name: Registration-Workflow-Stats
            duck_type: registration
            settings:
              cache_timeout: 60800
              authenticated_user_role_name: Student
              email_domain: byu.edu
              sender_email: byu-cs-course-ops@cs.byu.edu
              ta_channel_id: 1371951756149260298
              suspicion_checker_tool: check_suspicion_bot
        timeout: 600

      - channel_id: 1371951696061661215
        channel_name: duck-pond
        ducks:
          - standard-rubber-duck
        timeout: 600

      - channel_id: 1374066971523678279
        channel_name: stats-tool
        ducks:
          - stats-duck
        timeout: 600


  1354902266246598928:
    server_name: Physics
    channels:
      - channel_id: 1363949553102880869
        channel_name: review-phys-230
        ducks:
          - name: Conversation-Review-Phys-230
            duck_type: conversation_review
            settings:
              target_channel_ids:
                - 1363949528201564170
        timeout: 300

      - channel_id: 1363949528201564170
        channel_name: physics-230-phys230
        ducks:
          - standard-rubber-duck
        timeout: 600

      - channel_id: 1359587713749094700
        channel_name: review-phys-430
        ducks:
          - name: Conversation-Review-Phys-430
            duck_type: conversation_review
            settings:
              target_channel_ids:
                - 1359587525605458030
        timeout: 300

      - channel_id: 1359587525605458030
        channel_name: physics-430-phys430
        ducks:
          - standard-rubber-duck
        timeout: 600


  1338616224858374287:
    server_name: Rubber Duck Demo Server
    channels:
      - channel_id: 1338619665789751337
        channel_name: vintage-duck-review
        ducks:
          - name: Conversation-Review-Demo
            duck_type: conversation_review
            settings:
              target_channel_ids:
                - 1338616283671040000
        timeout: 300

      - channel_id: 1338616283671040000
        channel_name: vintage-duck
        ducks:
          - standard-rubber-duck
        timeout: 600


      - channel_id: 1401960218870419647
        channel_name: emoji-duck
        ducks:
          - name: Emoji-Duck-Demo
            duck_type: agent_led_conversation
            settings:
              agent:
                name: emoji-duck
                engine: gpt-4.1
                prompt_files:
                  - prompts/production-prompts/emoji.txt
                tools: [ ]
              file_size_limit: *file_size_limit
              file_type_ext: *file_type_ext
        timeout: 2000


      - channel_id: 1385293810782965830
        channel_name: code-complexity-analysis-duck
        ducks:
          - name: Code-Complexity-Duck-Demo
            duck_type: agent_led_conversation
            settings:
              file_size_limit: 5100
              file_type_ext: [ "py", "java", "cpp", "c", "h", "hpp", "ts", "js" ]
              agent:
                name: ComplexityDuck
                prompt: |
                  You are a helpful CS assistant.
                  You explain Big-O analysis. 
                  You can use the provided tools to generate a complexity analysis report
                  when the user provides a code file.
                  Keep your responses brief and clear. Provide the tool output to the user verbatim.
                tools:
                  - generate_code_complexity_analysis
                engine: gpt-5-mini
                reasoning: minimal
        timeout: 600


      - channel_id: 1379953844540407969
        channel_name: socratic-duck
        ducks:
          - name: Socratic-Rubber-Duck-Demo
            duck_type: agent_led_conversation
            settings:
              agent:
                name: socrates
                prompt_files:
                  - prompts/production-prompts/socratic-duck.txt
                engine: gpt-4.1
                tools: [ ]
              file_size_limit: *file_size_limit
              file_type_ext: *file_type_ext
        timeout: 600

      - channel_id: 1379959992110546995
        channel_name: join-the-server
        ducks:
          - name: Registration-Workflow-Demo
            duck_type: registration
            settings:
              cache_timeout: 60800
              authenticated_user_role_name: I-passed-registration
              ta_channel_id: 1379965339428720700
              suspicion_checker_tool: check_suspicion_bot
              email_domain: byu.edu
              roles:
                patterns:
                  - name: Teacher Sections
                    pattern: "-section-\\d{3}$"
                    description: Teacher name followed by section number (e.g. smith-section-001)
                  - name: Lab Sections
                    pattern: "^lab-section-\\d{3}$"
                    description: Lab section number (e.g. lab-section-002)
        timeout: 600


      - channel_id: 1384678077694480434
        channel_name: designer-duck
        ducks:
          - name: Phd-Duck-Demo
            duck_type: agent_led_conversation
            settings:
              agent:
                name: PhdDuck
                engine: gpt-4.1
                prompt_files:
                  - prompts/312-project-design/phd-duck.txt
                  - prompts/312-project-design/convex-hull/project-design-convex-hull.txt
                tools: [ ]
              file_size_limit: *file_size_limit
              file_type_ext: *file_type_ext
        timeout: 600

      - channel_id: 1379955387587104829
        channel_name: stats-tool
        ducks:
          - stats-duck
        timeout: 600

feedback_notifier_settings:
  feedback_check_hour: 9
  feedback_check_minute: 0

admin_settings:
  admin_channel_id: 1192895746672951340
  admin_role_id: 933123843038535741
  log_level: WARNING

sender_email: byu-cs-course-ops@cs.byu.edu

dataset_folder_locations:
  - s3://stats121-datasets/datasets/

ai_completion_retry_protocol:
  max_retries: 2
  delay: 2
  backoff: 2

reporter_settings:
  gpt_pricing:
    "gpt-5": [ 1.25, 10.00 ]
    "gpt-5-mini": [ 0.25, 2.00 ]
    "gpt-5-nano": [ 0.05, 0.40 ]
    "gpt-4.1": [ 2.00, 8.00 ]
    "gpt-4.1-mini": [ 0.40, 1.60 ]
    "gpt-4.1-nano": [ 0.01, 0.04 ]

    "gpt-4": [ 0.03, 0.06 ]
    "gpt-4o": [ 0.0025, 0.01 ]
    "gpt-4-1106-preview": [ 0.01, 0.03 ]
    "gpt-4-0125-preview": [ 0.01, 0.03 ]
    "o4-mini": [ 0.000150, 0.0006 ]
    "gpt-4-turbo": [ 0.01, 0.03 ]
    "gpt-4-turbo-preview": [ 0.01, 0.03 ]
    "gpt-3.5-turbo-1106": [ 0.001, 0.002 ]
    "gpt-3.5-turbo": [ 0.001, 0.003 ]
